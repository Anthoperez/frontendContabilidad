<mat-card>
  <mat-card-header>
    <mat-card-title>Importar Gastos desde Excel</mat-card-title>
    <mat-card-subtitle>Carga un archivo para procesar todas sus hojas automáticamente</mat-card-subtitle>
  </mat-card-header>
  
  <mat-card-content>
    <input 
      type="file" 
      (change)="onFileChange($event)" 
      id="file-input"
      accept=".xlsx, .xls"
      hidden
      #fileInput 
    />

    <button mat-raised-button color="primary" (click)="fileInput.click()" [disabled]="processing">
      <span *ngIf="!fileName">Seleccionar Archivo</span>
      <span *ngIf="fileName">Reemplazar: {{ fileName }}</span>
    </button>
    
    <p *ngIf="fileName && !processing" class="file-info">
      Archivo cargado: <strong>{{ fileName }}</strong>
    </p>

    <div *ngIf="processing" class="progress-container">
      <p>Procesando archivo, por favor espera...</p>
      <mat-progress-bar mode="indeterminate"></mat-progress-bar>
    </div>

    <div *ngIf="recordCount > 0 && !processing" class="summary">
      <p>
        <strong>{{ recordCount }}</strong> registros válidos encontrados y listos para ser importados.
      </p>
    </div>
  </mat-card-content>

  <mat-card-actions>
    <button 
      mat-raised-button 
      color="accent" 
      [disabled]="recordCount === 0 || processing" 
      (click)="uploadData()">
      Importar {{ recordCount }} Registros
    </button>
  </mat-card-actions>
</mat-card>